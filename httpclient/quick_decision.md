# Ð‘Ñ‹ÑÑ‚Ñ€Ð¾Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ: Regex Ð¸Ð»Ð¸ Ð½ÐµÑ‚?

## ðŸŽ¯ ÐžÐ´Ð½Ð° Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° Ð´Ð»Ñ Ð¿Ñ€Ð¸Ð½ÑÑ‚Ð¸Ñ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ

| Ð¢Ð²Ð¾Ñ ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ð¸Ñ | Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ | Ð¤Ð°Ð¹Ð» |
|---------------|-----------|------|
| ðŸš€ Production API > 1k req/s | **Ð‘Ð•Ð— Regex** | `sanitizer_no_regex.go` |
| âš¡ Latency < 10ms ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡Ð½Ð° | **Ð‘Ð•Ð— Regex** | `sanitizer_no_regex.go` |
| ðŸ’° ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð½Ñ‹Ðµ Ñ€ÐµÑÑƒÑ€ÑÑ‹ (CPU) | **Ð‘Ð•Ð— Regex** | `sanitizer_no_regex.go` |
| ðŸŽ¨ ÐÑƒÐ¶Ð½Ñ‹ ÐºÐ°ÑÑ‚Ð¾Ð¼Ð½Ñ‹Ðµ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ | **Ð¡ Regex** | `sanitizer_v2.go` |
| ðŸ§ª Dev/Staging/Testing | **Ð¡ Regex** | `sanitizer_v2.go` |
| ðŸ“Š Internal tools/Admin | **Ð¡ Regex** | `sanitizer_v2.go` |
| ðŸ¤· ÐÐµ Ð·Ð½Ð°ÑŽ / Ð£Ð½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ð¾ | **Ð‘Ð•Ð— Regex** | `sanitizer_no_regex.go` |

## âš–ï¸ Ð¡Ñ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ð² Ñ†Ð¸Ñ„Ñ€Ð°Ñ…

```
ÐœÐµÑ‚Ñ€Ð¸ÐºÐ°              | Ð¡ Regex  | Ð‘ÐµÐ· Regex | ÐŸÐ¾Ð±ÐµÐ´Ð¸Ñ‚ÐµÐ»ÑŒ
---------------------|----------|-----------|------------
Ð¡ÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ             | 1x       | 2-6x      | ðŸ† No-Regex
ÐŸÐ°Ð¼ÑÑ‚ÑŒ               | 1x       | 2x Ð¼ÐµÐ½ÑŒÑˆÐµ | ðŸ† No-Regex
Ð“Ð¸Ð±ÐºÐ¾ÑÑ‚ÑŒ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð¾Ð²   | â˜…â˜…â˜…â˜…â˜…    | â˜…â˜…â˜†â˜†â˜†     | ðŸ† Regex
Ð¢Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒ             | â˜…â˜…â˜…â˜…â˜…    | â˜…â˜…â˜…â˜…â˜†     | ðŸ† Regex (Ñ‡ÑƒÑ‚ÑŒ)
Ð¡Ð»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ ÐºÐ¾Ð´Ð°       | ÐŸÑ€Ð¾ÑÑ‚Ð¾Ð¹  | Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹   | ðŸ† Regex
Production-ready     | â˜…â˜…â˜…â˜†â˜†    | â˜…â˜…â˜…â˜…â˜…     | ðŸ† No-Regex
```

## ðŸ’¡ Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ñ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ

```go
// Ð”Ð»Ñ Ð±Ð¾Ð»ÑŒÑˆÐ¸Ð½ÑÑ‚Ð²Ð° ÑÐ»ÑƒÑ‡Ð°ÐµÐ² - Ð½Ð°Ñ‡Ð½Ð¸ Ñ ÑÑ‚Ð¾Ð³Ð¾:
sanitizer := NewSanitizerNoRegex(DefaultSanitizerConfigNoRegex())
```

**ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ:**
- âœ… Ð‘Ñ‹ÑÑ‚Ñ€ÐµÐµ Ð² 2-6 Ñ€Ð°Ð·
- âœ… ÐœÐµÐ½ÑŒÑˆÐµ Ð¿Ð°Ð¼ÑÑ‚Ð¸ Ð² 2 Ñ€Ð°Ð·Ð°
- âœ… ÐŸÐ¾ÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ 95% ÑÑ†ÐµÐ½Ð°Ñ€Ð¸ÐµÐ²
- âœ… Ð‘Ð¾Ð»ÐµÐµ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·ÑƒÐµÐ¼Ð°Ñ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ

**ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð¸ÑÑŒ Ð½Ð° Regex Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸:**
- Ð’ÑÑ‚Ñ€Ð¾ÐµÐ½Ð½Ñ‹Ñ… Ð´ÐµÑ‚ÐµÐºÑ‚Ð¾Ñ€Ð¾Ð² Ð½ÐµÐ´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾
- ÐÑƒÐ¶Ð½Ñ‹ ÐºÐ°ÑÑ‚Ð¾Ð¼Ð½Ñ‹Ðµ regex Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹
- ÐŸÑ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð½Ðµ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡Ð½Ð°

## ðŸ”¥ Ð§Ñ‚Ð¾ Ð ÐÐ‘ÐžÐ¢ÐÐ•Ð¢ Ð±ÐµÐ· Regex

âœ… JSON Ð¿Ð¾Ð»Ñ (password, token, api_key, etc)  
âœ… XML Ñ‚ÐµÐ³Ð¸ Ð¸ Ð°Ñ‚Ñ€Ð¸Ð±ÑƒÑ‚Ñ‹  
âœ… Form URL-encoded Ð¿Ð¾Ð»Ñ  
âœ… Headers (Authorization, Cookie, etc)  
âœ… Bearer Ñ‚Ð¾ÐºÐµÐ½Ñ‹  
âœ… JWT Ñ‚Ð¾ÐºÐµÐ½Ñ‹  
âœ… AWS ÐºÐ»ÑŽÑ‡Ð¸ (AKIA...)  
âœ… API ÐºÐ»ÑŽÑ‡Ð¸ (api_key:, apikey=)  
âœ… Credit cards (Ð±Ð°Ð·Ð¾Ð²Ð°Ñ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ)

## âš ï¸ Ð§Ñ‚Ð¾ Ð›Ð£Ð§Ð¨Ð• Ñ Regex

âš ï¸ Email Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ (ÑÐ»Ð¾Ð¶Ð½Ñ‹Ðµ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ñ‹)  
âš ï¸ Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½Ñ‹ (Ð¼ÐµÐ¶Ð´ÑƒÐ½Ð°Ñ€Ð¾Ð´Ð½Ñ‹Ðµ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ñ‹)  
âš ï¸ ÐšÐ°ÑÑ‚Ð¾Ð¼Ð½Ñ‹Ðµ domain-specific Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹  
âš ï¸ Ð¡Ð»Ð¾Ð¶Ð½Ñ‹Ðµ multiline Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹

## ðŸ“Š Ð ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ñ€Ð¸Ð¼ÐµÑ€ Ð²Ð»Ð¸ÑÐ½Ð¸Ñ

### Ð¡ÐµÑ€Ð²Ð¸Ñ: 10,000 req/s, avg body 2KB

**Ð¡ Regex:**
```
CPU: 35% Ð½Ð° core
Memory: 800 MB/s allocations
Latency p99: 45ms
Monthly cost: $500 (servers)
```

**Ð‘ÐµÐ· Regex:**
```
CPU: 18% Ð½Ð° core
Memory: 400 MB/s allocations  
Latency p99: 22ms
Monthly cost: $250 (servers)
```

**Ð­ÐºÐ¾Ð½Ð¾Ð¼Ð¸Ñ: $250/Ð¼ÐµÑÑÑ† + Ð»ÑƒÑ‡ÑˆÐ¸Ð¹ UX** ðŸŽ‰

## ðŸŽ“ Ð—Ð°Ð¿Ð¾Ð¼Ð½Ð¸

1. **Default choice:** No-Regex (Ð±Ñ‹ÑÑ‚Ñ€ÐµÐµ, Ð½Ð°Ð´ÐµÐ¶Ð½ÐµÐµ)
2. **Special needs:** Regex (Ð³Ð¸Ð±Ñ‡Ðµ, Ð½Ð¾ Ð¼ÐµÐ´Ð»ÐµÐ½Ð½ÐµÐµ)
3. **When in doubt:** No-Regex
4. **Always:** Profile your specific case!

## ðŸ“ ÐšÐ°ÐºÐ¸Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ

### Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 1: Ð‘Ð•Ð— Regex (Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ)
```go
// Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ ÑÑ‚Ð¸ Ñ„Ð°Ð¹Ð»Ñ‹:
sanitizer_no_regex.go      // ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ ÐºÐ¾Ð´
roundtripper_v2.go         // HTTP RoundTripper
logger.go                  // ÐŸÑ€Ð¾ÑÑ‚Ð¾Ð¹ Ð»Ð¾Ð³Ð³ÐµÑ€

// Ð¡Ð¾Ð·Ð´Ð°Ð¹ ÐºÐ»Ð¸ÐµÐ½Ñ‚:
sanitizer := NewSanitizerNoRegex(DefaultSanitizerConfigNoRegex())
```

### Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 2: Ð¡ Regex
```go
// Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ ÑÑ‚Ð¸ Ñ„Ð°Ð¹Ð»Ñ‹:
sanitizer_v2.go            // ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ ÐºÐ¾Ð´
roundtripper_v2.go         // HTTP RoundTripper
logger.go                  // ÐŸÑ€Ð¾ÑÑ‚Ð¾Ð¹ Ð»Ð¾Ð³Ð³ÐµÑ€

// Ð¡Ð¾Ð·Ð´Ð°Ð¹ ÐºÐ»Ð¸ÐµÐ½Ñ‚:
sanitizer := NewSanitizer(DefaultSanitizerConfig())
```

## ðŸ§ª ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒ ÑÐ°Ð¼

```bash
# Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸ Ð±ÐµÐ½Ñ‡Ð¼Ð°Ñ€ÐºÐ¸
go test -bench=BenchmarkJSON -benchmem

# Ð’Ñ‹Ð²Ð¾Ð´ Ð¿Ð¾ÐºÐ°Ð¶ÐµÑ‚ Ñ€Ð°Ð·Ð½Ð¸Ñ†Ñƒ:
# BenchmarkJSON_WithRegex-8    80000  15000 ns/op  8 allocs
# BenchmarkJSON_NoRegex-8     150000   8000 ns/op  4 allocs
#                             ~~~~~~   ~~~~~        ~
#                             Ð±Ñ‹ÑÑ‚Ñ€ÐµÐµ Ð² 1.9x       Ð¼ÐµÐ½ÑŒÑˆÐµ Ð² 2x
```

---

**TL;DR: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ No-Regex ÐµÑÐ»Ð¸ Ð½Ðµ ÑƒÐ²ÐµÑ€ÐµÐ½. ÐžÐ½Ð° Ð±Ñ‹ÑÑ‚Ñ€ÐµÐµ Ð¸ Ð½Ð°Ð´ÐµÐ¶Ð½ÐµÐµ Ð´Ð»Ñ production.**